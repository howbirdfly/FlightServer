# å®¢æˆ·ç«¯æ”¹é€ è¯¦ç»†æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [æœåŠ¡ç«¯æ¥å£è¯´æ˜](#æœåŠ¡ç«¯æ¥å£è¯´æ˜)
2. [é€šä¿¡åè®®è¯¦è§£](#é€šä¿¡åè®®è¯¦è§£)
3. [ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç½‘ç»œå®¢æˆ·ç«¯ç±»](#ç¬¬ä¸€æ­¥åˆ›å»ºç½‘ç»œå®¢æˆ·ç«¯ç±»)
4. [ç¬¬äºŒæ­¥ï¼šä¿®æ”¹é¡¹ç›®é…ç½®](#ç¬¬äºŒæ­¥ä¿®æ”¹é¡¹ç›®é…ç½®)
5. [ç¬¬ä¸‰æ­¥ï¼šæ”¹é€ å„åŠŸèƒ½æ¨¡å—](#ç¬¬ä¸‰æ­¥æ”¹é€ å„åŠŸèƒ½æ¨¡å—)
6. [å®Œæ•´ä»£ç ç¤ºä¾‹](#å®Œæ•´ä»£ç ç¤ºä¾‹)
7. [æµ‹è¯•å’Œè°ƒè¯•](#æµ‹è¯•å’Œè°ƒè¯•)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ–¥ï¸ æœåŠ¡ç«¯æ¥å£è¯´æ˜

### æœåŠ¡ç«¯åŸºæœ¬ä¿¡æ¯

- **IPåœ°å€**ï¼š127.0.0.1ï¼ˆæœ¬åœ°ï¼‰æˆ–æœåŠ¡å™¨IP
- **ç«¯å£**ï¼š8888
- **åè®®**ï¼šTCP Socket
- **æ•°æ®æ ¼å¼**ï¼šJSONï¼ˆUTF-8ç¼–ç ï¼‰
- **æ¶ˆæ¯æ ¼å¼**ï¼šé•¿åº¦å‰ç¼€ï¼ˆ4å­—èŠ‚ï¼‰+ JSONæ•°æ®

### æœåŠ¡ç«¯æ”¯æŒçš„åŠŸèƒ½

| åŠŸèƒ½ | æ¶ˆæ¯ç±»å‹ | è¯·æ±‚æ¶ˆæ¯ | å“åº”æ¶ˆæ¯ |
|------|---------|---------|---------|
| ç”¨æˆ·ç™»å½• | MSG_LOGIN (1001) | ç”¨æˆ·åã€å¯†ç  | ç™»å½•ç»“æœã€userID |
| ç”¨æˆ·æ³¨å†Œ | MSG_REGISTER (1003) | ç”¨æˆ·åã€å¯†ç ã€èº«ä»½è¯ã€ç”µè¯ | æ³¨å†Œç»“æœã€userID |
| æŸ¥è¯¢ç¥¨åŠ¡ | MSG_SEARCH_TICKETS (2001) | å‡ºå‘åœ°ã€ç›®çš„åœ°ã€æ—¥æœŸã€ç±»å‹ | ç¥¨åŠ¡åˆ—è¡¨ |
| åˆ›å»ºè®¢å• | MSG_CREATE_ORDER (3001) | userIDã€ticketIDã€èˆ±ä½ç±»å‹ã€æ•°é‡ | è®¢å•IDã€æ€»ä»· |
| è·å–è®¢å•åˆ—è¡¨ | MSG_GET_ORDERS (3003) | userID | è®¢å•åˆ—è¡¨ |
| å–æ¶ˆè®¢å• | MSG_CANCEL_ORDER (3005) | orderID | å–æ¶ˆç»“æœ |
| æ·»åŠ æ”¶è— | MSG_ADD_FAVORITE (4001) | userIDã€ticketID | æ·»åŠ ç»“æœ |
| è·å–æ”¶è—åˆ—è¡¨ | MSG_GET_FAVORITES (4003) | userID | æ”¶è—åˆ—è¡¨ |
| åˆ é™¤æ”¶è— | MSG_DELETE_FAVORITE (4005) | favoriteID | åˆ é™¤ç»“æœ |

---

## ğŸ“¡ é€šä¿¡åè®®è¯¦è§£

### æ¶ˆæ¯æ ¼å¼

#### è¯·æ±‚æ¶ˆæ¯æ ¼å¼

```json
{
    "type": æ¶ˆæ¯ç±»å‹ï¼ˆæ•´æ•°ï¼‰,
    "data": {
        // å…·ä½“çš„ä¸šåŠ¡æ•°æ®
    }
}
```

#### å“åº”æ¶ˆæ¯æ ¼å¼

```json
{
    "type": å“åº”ç±»å‹ï¼ˆæ•´æ•°ï¼‰,
    "success": true/false,
    "message": "æ¶ˆæ¯æè¿°ï¼ˆå­—ç¬¦ä¸²ï¼‰",
    "data": {
        // è¿”å›çš„æ•°æ®ï¼ˆå¯èƒ½ä¸ºnullï¼‰
    }
}
```

### æ•°æ®åŒ…æ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é•¿åº¦å‰ç¼€ï¼ˆ4å­—èŠ‚ï¼Œquint32ï¼‰           â”‚
â”‚  è¡¨ç¤ºJSONæ•°æ®çš„å­—èŠ‚æ•°                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  JSONæ•°æ®ï¼ˆNå­—èŠ‚ï¼‰                   â”‚
â”‚  UTF-8ç¼–ç çš„JSONå­—ç¬¦ä¸²               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç²˜åŒ…å¤„ç†

æœåŠ¡ç«¯ä½¿ç”¨**é•¿åº¦å‰ç¼€**æ–¹å¼å¤„ç†ç²˜åŒ…ï¼Œå®¢æˆ·ç«¯ä¹Ÿéœ€è¦ä½¿ç”¨ç›¸åŒçš„æ–¹å¼ï¼š
1. å‘é€æ—¶ï¼šå…ˆå‘é€4å­—èŠ‚é•¿åº¦ï¼Œå†å‘é€JSONæ•°æ®
2. æ¥æ”¶æ—¶ï¼šå…ˆè¯»å–4å­—èŠ‚é•¿åº¦ï¼Œå†æ ¹æ®é•¿åº¦è¯»å–JSONæ•°æ®

---

## ğŸ”§ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç½‘ç»œå®¢æˆ·ç«¯ç±»

### 1.1 åˆ›å»º networkclient.h

åœ¨å®¢æˆ·ç«¯é¡¹ç›®ä¸­åˆ›å»º `networkclient.h` æ–‡ä»¶ï¼š

```cpp
#ifndef NETWORKCLIENT_H
#define NETWORKCLIENT_H

#include <QTcpSocket>
#include <QJsonDocument>
#include <QJsonObject>
#include <QObject>
#include <QDataStream>

class NetworkClient : public QObject
{
    Q_OBJECT

public:
    explicit NetworkClient(QObject *parent = nullptr);
    ~NetworkClient();
    
    // è¿æ¥å’Œæ–­å¼€
    bool connectToServer(const QString &host = "127.0.0.1", quint16 port = 8888);
    void disconnectFromServer();
    bool isConnected() const;
    
    // å‘é€è¯·æ±‚
    void sendRequest(int msgType, const QJsonObject &data);

signals:
    // å“åº”ä¿¡å·
    void responseReceived(int msgType, bool success, const QString &message, const QJsonObject &data);
    
    // è¿æ¥çŠ¶æ€ä¿¡å·
    void connectionStatusChanged(bool connected);
    void errorOccurred(const QString &error);

private slots:
    void onReadyRead();
    void onConnected();
    void onDisconnected();
    void onError(QAbstractSocket::SocketError error);

private:
    QTcpSocket *socket;
    quint32 expectedDataSize;  // æœŸæœ›æ¥æ”¶çš„æ•°æ®å¤§å°
};

#endif // NETWORKCLIENT_H
```

### 1.2 åˆ›å»º networkclient.cpp

åˆ›å»º `networkclient.cpp` æ–‡ä»¶ï¼š

```cpp
#include "networkclient.h"
#include <QDebug>
#include <QHostAddress>

NetworkClient::NetworkClient(QObject *parent)
    : QObject(parent)
    , socket(nullptr)
    , expectedDataSize(0)
{
    socket = new QTcpSocket(this);
    
    // è¿æ¥ä¿¡å·
    connect(socket, &QTcpSocket::readyRead, this, &NetworkClient::onReadyRead);
    connect(socket, &QTcpSocket::connected, this, &NetworkClient::onConnected);
    connect(socket, &QTcpSocket::disconnected, this, &NetworkClient::onDisconnected);
    connect(socket, QOverload<QAbstractSocket::SocketError>::of(&QAbstractSocket::errorOccurred),
            this, &NetworkClient::onError);
}

NetworkClient::~NetworkClient()
{
    if (socket) {
        socket->disconnectFromHost();
        socket->deleteLater();
    }
}

bool NetworkClient::connectToServer(const QString &host, quint16 port)
{
    if (socket->state() == QAbstractSocket::ConnectedState) {
        qDebug() << "å·²ç»è¿æ¥åˆ°æœåŠ¡å™¨";
        return true;
    }
    
    socket->connectToHost(host, port);
    return socket->waitForConnected(3000);  // ç­‰å¾…3ç§’
}

void NetworkClient::disconnectFromServer()
{
    if (socket) {
        socket->disconnectFromHost();
    }
}

bool NetworkClient::isConnected() const
{
    return socket && socket->state() == QAbstractSocket::ConnectedState;
}

void NetworkClient::sendRequest(int msgType, const QJsonObject &data)
{
    if (!socket || socket->state() != QAbstractSocket::ConnectedState) {
        emit errorOccurred("æœªè¿æ¥åˆ°æœåŠ¡å™¨");
        return;
    }
    
    // æ„é€ è¯·æ±‚æ¶ˆæ¯
    QJsonObject request;
    request["type"] = msgType;
    request["data"] = data;
    
    // è½¬æ¢ä¸ºJSON
    QJsonDocument doc(request);
    QByteArray jsonData = doc.toJson(QJsonDocument::Compact);
    
    // æ·»åŠ é•¿åº¦å‰ç¼€
    QByteArray packet;
    QDataStream stream(&packet, QIODevice::WriteOnly);
    stream.setVersion(QDataStream::Qt_6_0);
    stream << (quint32)jsonData.size();
    packet.append(jsonData);
    
    // å‘é€æ•°æ®
    socket->write(packet);
    socket->flush();
    
    qDebug() << "å‘é€æ¶ˆæ¯ç±»å‹ï¼š" << msgType << "ï¼Œæ•°æ®å¤§å°ï¼š" << jsonData.size() << "å­—èŠ‚";
}

void NetworkClient::onReadyRead()
{
    QDataStream in(socket);
    in.setVersion(QDataStream::Qt_6_0);
    
    // å¾ªç¯å¤„ç†å¯èƒ½çš„å¤šæ¡æ¶ˆæ¯ï¼ˆç²˜åŒ…å¤„ç†ï¼‰
    while (true) {
        // å¦‚æœè¿˜æ²¡æœ‰è¯»å–é•¿åº¦ï¼Œå…ˆè¯»å–é•¿åº¦
        if (expectedDataSize == 0) {
            if (socket->bytesAvailable() < sizeof(quint32)) {
                break;  // é•¿åº¦å­—æ®µéƒ½ä¸å®Œæ•´ï¼Œç­‰å¾…
            }
            in >> expectedDataSize;
        }
        
        // æ£€æŸ¥æ•°æ®æ˜¯å¦å®Œæ•´
        if (socket->bytesAvailable() < expectedDataSize) {
            break;  // æ•°æ®ä¸å®Œæ•´ï¼Œç­‰å¾…
        }
        
        // è¯»å–å®Œæ•´çš„JSONæ•°æ®
        QByteArray jsonData = socket->read(expectedDataSize);
        expectedDataSize = 0;  // é‡ç½®ï¼Œå‡†å¤‡è¯»å–ä¸‹ä¸€æ¡æ¶ˆæ¯
        
        // è§£æJSON
        QJsonParseError error;
        QJsonDocument doc = QJsonDocument::fromJson(jsonData, &error);
        
        if (error.error == QJsonParseError::NoError && doc.isObject()) {
            QJsonObject obj = doc.object();
            int msgType = obj["type"].toInt();
            bool success = obj["success"].toBool();
            QString message = obj["message"].toString();
            QJsonObject data = obj["data"].toObject();
            
            // å‘å‡ºå“åº”ä¿¡å·
            emit responseReceived(msgType, success, message, data);
        } else {
            qDebug() << "JSONè§£æé”™è¯¯ï¼š" << error.errorString();
        }
    }
}

void NetworkClient::onConnected()
{
    qDebug() << "å·²è¿æ¥åˆ°æœåŠ¡å™¨";
    emit connectionStatusChanged(true);
}

void NetworkClient::onDisconnected()
{
    qDebug() << "ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥";
    expectedDataSize = 0;  // é‡ç½®çŠ¶æ€
    emit connectionStatusChanged(false);
}

void NetworkClient::onError(QAbstractSocket::SocketError error)
{
    QString errorString = "ç½‘ç»œé”™è¯¯ï¼š";
    switch (error) {
        case QAbstractSocket::ConnectionRefusedError:
            errorString += "è¿æ¥è¢«æ‹’ç»";
            break;
        case QAbstractSocket::RemoteHostClosedError:
            errorString += "æœåŠ¡å™¨å…³é—­è¿æ¥";
            break;
        case QAbstractSocket::HostNotFoundError:
            errorString += "æ‰¾ä¸åˆ°æœåŠ¡å™¨";
            break;
        case QAbstractSocket::NetworkError:
            errorString += "ç½‘ç»œé”™è¯¯";
            break;
        default:
            errorString += socket->errorString();
            break;
    }
    
    qDebug() << errorString;
    emit errorOccurred(errorString);
}
```

### 1.3 åˆ›å»ºç½‘ç»œç®¡ç†å™¨ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰

åˆ›å»º `networkmanager.h`ï¼š

```cpp
#ifndef NETWORKMANAGER_H
#define NETWORKMANAGER_H

#include "networkclient.h"

class NetworkManager : public QObject
{
    Q_OBJECT

public:
    static NetworkManager* instance();
    NetworkClient* client() { return m_client; }
    
    bool connectToServer(const QString &host = "127.0.0.1", quint16 port = 8888);

private:
    NetworkManager(QObject *parent = nullptr);
    static NetworkManager* m_instance;
    NetworkClient *m_client;
};

#endif // NETWORKMANAGER_H
```

åˆ›å»º `networkmanager.cpp`ï¼š

```cpp
#include "networkmanager.h"
#include <QDebug>

NetworkManager* NetworkManager::m_instance = nullptr;

NetworkManager::NetworkManager(QObject *parent)
    : QObject(parent)
    , m_client(nullptr)
{
    m_client = new NetworkClient(this);
}

NetworkManager* NetworkManager::instance()
{
    if (!m_instance) {
        m_instance = new NetworkManager();
    }
    return m_instance;
}

bool NetworkManager::connectToServer(const QString &host, quint16 port)
{
    return m_client->connectToServer(host, port);
}
```

---

## âš™ï¸ ç¬¬äºŒæ­¥ï¼šä¿®æ”¹é¡¹ç›®é…ç½®

### 2.1 ä¿®æ”¹ .pro æ–‡ä»¶

åœ¨å®¢æˆ·ç«¯çš„ `.pro` æ–‡ä»¶ä¸­æ·»åŠ ç½‘ç»œæ¨¡å—ï¼š

```pro
QT += core gui sql widgets network
```

### 2.2 ä¿®æ”¹ main.cpp

**åˆ é™¤**æ‰€æœ‰æ•°æ®åº“è¿æ¥ä»£ç ï¼Œ**æ·»åŠ **ç½‘ç»œè¿æ¥ï¼š

```cpp
#include "mainwindow.h"
#include "networkmanager.h"
#include <QApplication>
#include <QMessageBox>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    
    // è¿æ¥æœåŠ¡å™¨
    if (!NetworkManager::instance()->connectToServer()) {
        QMessageBox::critical(nullptr, "é”™è¯¯", 
            "æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼\nè¯·ç¡®ä¿æœåŠ¡ç«¯å·²å¯åŠ¨ã€‚");
        return -1;
    }
    
    MainWindow w;
    w.show();
    
    return a.exec();
}
```

---

## ğŸ”„ ç¬¬ä¸‰æ­¥ï¼šæ”¹é€ å„åŠŸèƒ½æ¨¡å—

### 3.1 æ”¹é€ ç™»å½•åŠŸèƒ½

#### åŸæ¥çš„ä»£ç ï¼ˆéœ€è¦åˆ é™¤ï¼‰

```cpp
void MainWindow::on_log_in_clicked()
{
    QString username = ui->Usernamet->text().trimmed();
    QString password = ui->Passwordt->text().trimmed();
    
    // âŒ åˆ é™¤è¿™äº›æ•°æ®åº“æ“ä½œ
    ConnectDatabase();
    QString userid = GetUserID(username, password);
    
    if (!userid.isEmpty()) {
        // ç™»å½•æˆåŠŸ
        Deal *d = new Deal(userid);
        d->show();
        this->close();
    } else {
        QMessageBox::warning(this, "æç¤º", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
    }
}
```

#### æ”¹é€ åçš„ä»£ç 

```cpp
void MainWindow::on_log_in_clicked()
{
    QString username = ui->Usernamet->text().trimmed();
    QString password = ui->Passwordt->text().trimmed();
    
    if (username.isEmpty() || password.isEmpty()) {
        QMessageBox::warning(this, "æç¤º", "ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©ºï¼");
        return;
    }
    
    NetworkClient *client = NetworkManager::instance()->client();
    
    // è¿æ¥å“åº”ä¿¡å·ï¼ˆä½¿ç”¨Qt::UniqueConnectioné¿å…é‡å¤è¿æ¥ï¼‰
    connect(client, &NetworkClient::responseReceived,
            this, &MainWindow::onLoginResponse, Qt::UniqueConnection);
    
    // æ„é€ è¯·æ±‚æ•°æ®
    QJsonObject data;
    data["username"] = username;
    data["password"] = password;
    
    // å‘é€ç™»å½•è¯·æ±‚
    client->sendRequest(MSG_LOGIN, data);
    
    // æ˜¾ç¤ºåŠ è½½æç¤ºï¼ˆå¯é€‰ï¼‰
    // QMessageBox::information(this, "æç¤º", "æ­£åœ¨ç™»å½•...");
}

// æ–°å¢ï¼šç™»å½•å“åº”å¤„ç†å‡½æ•°
void MainWindow::onLoginResponse(int msgType, bool success,
                                  const QString &message, const QJsonObject &data)
{
    // åªå¤„ç†ç™»å½•å“åº”
    if (msgType != MSG_LOGIN_RESPONSE) {
        return;
    }
    
    // æ–­å¼€ä¿¡å·è¿æ¥ï¼ˆé¿å…é‡å¤å¤„ç†ï¼‰
    disconnect(NetworkManager::instance()->client(), 
               &NetworkClient::responseReceived,
               this, &MainWindow::onLoginResponse);
    
    if (success) {
        QString userID = data["userID"].toString();
        QMessageBox::information(this, "æˆåŠŸ", "ç™»å½•æˆåŠŸï¼");
        
        // æ‰“å¼€ä¸»çª—å£
        Deal *d = new Deal(userID);
        d->setAttribute(Qt::WA_DeleteOnClose);
        d->show();
        this->close();
    } else {
        QMessageBox::warning(this, "å¤±è´¥", message);
    }
}
```

#### åœ¨ MainWindow.h ä¸­æ·»åŠ å£°æ˜

```cpp
private slots:
    void onLoginResponse(int msgType, bool success, 
                        const QString &message, const QJsonObject &data);
```

### 3.2 æ”¹é€ æ³¨å†ŒåŠŸèƒ½

#### åŸæ¥çš„ä»£ç ï¼ˆéœ€è¦åˆ é™¤ï¼‰

```cpp
void SignIn::on_sign_in_clicked()
{
    QString username = ui->username->text();
    QString password = ui->password->text();
    QString idCard = ui->idCard->text();
    QString phone = ui->phone->text();
    
    // âŒ åˆ é™¤æ‰€æœ‰æ•°æ®åº“æ“ä½œ
    ConnectDatabase();
    // ... æ•°æ®åº“æŸ¥è¯¢å’Œæ’å…¥ä»£ç  ...
}
```

#### æ”¹é€ åçš„ä»£ç 

```cpp
void SignIn::on_sign_in_clicked()
{
    QString username = ui->username->text().trimmed();
    QString password = ui->password->text().trimmed();
    QString idCard = ui->idCard->text().trimmed();
    QString phone = ui->phone->text().trimmed();
    
    // è¾“å…¥éªŒè¯
    if (username.isEmpty() || password.isEmpty() || 
        idCard.isEmpty() || phone.isEmpty()) {
        QMessageBox::warning(this, "æç¤º", "è¯·å¡«å†™å®Œæ•´ä¿¡æ¯ï¼");
        return;
    }
    
    NetworkClient *client = NetworkManager::instance()->client();
    
    // è¿æ¥å“åº”ä¿¡å·
    connect(client, &NetworkClient::responseReceived,
            this, &SignIn::onRegisterResponse, Qt::UniqueConnection);
    
    // æ„é€ è¯·æ±‚æ•°æ®
    QJsonObject data;
    data["username"] = username;
    data["password"] = password;
    data["idCard"] = idCard;
    data["phone"] = phone;
    
    // å‘é€æ³¨å†Œè¯·æ±‚
    client->sendRequest(MSG_REGISTER, data);
}

// æ–°å¢ï¼šæ³¨å†Œå“åº”å¤„ç†å‡½æ•°
void SignIn::onRegisterResponse(int msgType, bool success,
                                const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_REGISTER_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &SignIn::onRegisterResponse);
    
    if (success) {
        QMessageBox::information(this, "æˆåŠŸ", "æ³¨å†ŒæˆåŠŸï¼");
        this->close();  // å…³é—­æ³¨å†Œçª—å£
    } else {
        QMessageBox::warning(this, "å¤±è´¥", message);
    }
}
```

### 3.3 æ”¹é€ ç¥¨åŠ¡æŸ¥è¯¢åŠŸèƒ½

#### åŸæ¥çš„ä»£ç ï¼ˆéœ€è¦åˆ é™¤ï¼‰

```cpp
void Deal::searchTickets()
{
    QString from = ui->lineEdit_from->text();
    QString to = ui->lineEdit_to->text();
    QDate date = ui->dateEdit->date();
    QString type = ui->comboBox_type->currentText();
    
    // âŒ åˆ é™¤æ•°æ®åº“æŸ¥è¯¢ä»£ç 
    ConnectDatabase();
    QSqlQuery query;
    // ... æ•°æ®åº“æŸ¥è¯¢ ...
}
```

#### æ”¹é€ åçš„ä»£ç 

```cpp
void Deal::searchTickets()
{
    QString from = ui->lineEdit_from->text().trimmed();
    QString to = ui->lineEdit_to->text().trimmed();
    QDate date = ui->dateEdit->date();
    QString type = ui->comboBox_type->currentText();
    
    if (from.isEmpty() || to.isEmpty()) {
        QMessageBox::warning(this, "æç¤º", "è¯·å¡«å†™å‡ºå‘åœ°å’Œç›®çš„åœ°ï¼");
        return;
    }
    
    NetworkClient *client = NetworkManager::instance()->client();
    
    // è¿æ¥å“åº”ä¿¡å·
    connect(client, &NetworkClient::responseReceived,
            this, &Deal::onSearchResponse, Qt::UniqueConnection);
    
    // æ„é€ è¯·æ±‚æ•°æ®
    QJsonObject data;
    data["from"] = from;
    data["to"] = to;
    data["date"] = date.toString("yyyy-MM-dd");
    data["type"] = type;
    
    // å‘é€æŸ¥è¯¢è¯·æ±‚
    client->sendRequest(MSG_SEARCH_TICKETS, data);
    
    // æ¸…ç©ºè¡¨æ ¼ï¼Œå‡†å¤‡æ˜¾ç¤ºæ–°ç»“æœ
    ui->tableWidget_tickets->setRowCount(0);
}

// æ–°å¢ï¼šæŸ¥è¯¢å“åº”å¤„ç†å‡½æ•°
void Deal::onSearchResponse(int msgType, bool success,
                            const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_SEARCH_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &Deal::onSearchResponse);
    
    if (!success) {
        QMessageBox::warning(this, "é”™è¯¯", message);
        return;
    }
    
    // è§£æç¥¨åŠ¡åˆ—è¡¨
    QJsonArray tickets = data["tickets"].toArray();
    ui->tableWidget_tickets->setRowCount(0);
    
    for (const QJsonValue &value : tickets) {
        QJsonObject ticket = value.toObject();
        
        int row = ui->tableWidget_tickets->rowCount();
        ui->tableWidget_tickets->insertRow(row);
        
        // å¡«å……è¡¨æ ¼æ•°æ®
        ui->tableWidget_tickets->setItem(row, 0, 
            new QTableWidgetItem(ticket["flightNumber"].toString()));
        ui->tableWidget_tickets->setItem(row, 1,
            new QTableWidgetItem(ticket["departureCity"].toString()));
        ui->tableWidget_tickets->setItem(row, 2,
            new QTableWidgetItem(ticket["arrivalCity"].toString()));
        ui->tableWidget_tickets->setItem(row, 3,
            new QTableWidgetItem(ticket["departureTime"].toString()));
        ui->tableWidget_tickets->setItem(row, 4,
            new QTableWidgetItem(ticket["arrivalTime"].toString()));
        ui->tableWidget_tickets->setItem(row, 5,
            new QTableWidgetItem(ticket["flightDate"].toString()));
        
        // æ ¹æ®é€‰æ‹©çš„ç±»å‹æ˜¾ç¤ºä»·æ ¼
        QString type = ui->comboBox_type->currentText();
        double price = 0;
        if (type == "ç»æµèˆ±") {
            price = ticket["economyPrice"].toDouble();
        } else if (type == "å•†åŠ¡èˆ±") {
            price = ticket["businessPrice"].toDouble();
        } else if (type == "å¤´ç­‰èˆ±") {
            price = ticket["firstClassPrice"].toDouble();
        }
        
        ui->tableWidget_tickets->setItem(row, 6,
            new QTableWidgetItem(QString::number(price)));
        
        // ä¿å­˜ticketIDåˆ°è¡¨æ ¼çš„userDataä¸­ï¼ˆç”¨äºåç»­æ“ä½œï¼‰
        ui->tableWidget_tickets->item(row, 0)->setData(Qt::UserRole, 
            ticket["ticketID"].toString());
    }
    
    if (tickets.isEmpty()) {
        QMessageBox::information(this, "æç¤º", "æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç¥¨åŠ¡");
    }
}
```

### 3.4 æ”¹é€ åˆ›å»ºè®¢å•åŠŸèƒ½

#### æ”¹é€ åçš„ä»£ç 

```cpp
void OrderDialog::on_confirmButton_clicked()
{
    // è·å–é€‰ä¸­çš„ç¥¨åŠ¡ä¿¡æ¯
    int row = parentWidget()->findChild<QTableWidget*>()->currentRow();
    if (row < 0) {
        QMessageBox::warning(this, "æç¤º", "è¯·å…ˆé€‰æ‹©ç¥¨åŠ¡ï¼");
        return;
    }
    
    QString ticketID = parentWidget()->findChild<QTableWidget*>()->item(row, 0)
                       ->data(Qt::UserRole).toString();
    QString seatType = ui->seatTypeComboBox->currentText();
    int quantity = ui->quantitySpinBox->value();
    
    NetworkClient *client = NetworkManager::instance()->client();
    
    connect(client, &NetworkClient::responseReceived,
            this, &OrderDialog::onCreateOrderResponse, Qt::UniqueConnection);
    
    QJsonObject data;
    data["userID"] = m_userID;  // ä»ç™»å½•æ—¶ä¿å­˜çš„userID
    data["ticketID"] = ticketID;
    data["seatType"] = seatType;
    data["quantity"] = quantity;
    
    client->sendRequest(MSG_CREATE_ORDER, data);
}

void OrderDialog::onCreateOrderResponse(int msgType, bool success,
                                        const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_CREATE_ORDER_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &OrderDialog::onCreateOrderResponse);
    
    if (success) {
        double totalPrice = data["totalPrice"].toDouble();
        QMessageBox::information(this, "æˆåŠŸ", 
            QString("è®¢å•åˆ›å»ºæˆåŠŸï¼\nè®¢å•æ€»ä»·ï¼š%1å…ƒ").arg(totalPrice));
        this->accept();
    } else {
        QMessageBox::warning(this, "å¤±è´¥", message);
    }
}
```

### 3.5 æ”¹é€ è·å–è®¢å•åˆ—è¡¨åŠŸèƒ½

#### æ”¹é€ åçš„ä»£ç 

```cpp
void SingleCenter::loadOrders()
{
    NetworkClient *client = NetworkManager::instance()->client();
    
    connect(client, &NetworkClient::responseReceived,
            this, &SingleCenter::onGetOrdersResponse, Qt::UniqueConnection);
    
    QJsonObject data;
    data["userID"] = m_userID;
    
    client->sendRequest(MSG_GET_ORDERS, data);
}

void SingleCenter::onGetOrdersResponse(int msgType, bool success,
                                      const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_GET_ORDERS_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &SingleCenter::onGetOrdersResponse);
    
    if (!success) {
        QMessageBox::warning(this, "é”™è¯¯", message);
        return;
    }
    
    // è§£æè®¢å•åˆ—è¡¨
    QJsonArray orders = data["orders"].toArray();
    ui->ordersTableWidget->setRowCount(0);
    
    for (const QJsonValue &value : orders) {
        QJsonObject order = value.toObject();
        
        int row = ui->ordersTableWidget->rowCount();
        ui->ordersTableWidget->insertRow(row);
        
        // å¡«å……è¡¨æ ¼
        ui->ordersTableWidget->setItem(row, 0,
            new QTableWidgetItem(order["orderID"].toString()));
        ui->ordersTableWidget->setItem(row, 1,
            new QTableWidgetItem(order["flightNumber"].toString()));
        ui->ordersTableWidget->setItem(row, 2,
            new QTableWidgetItem(order["departureCity"].toString()));
        ui->ordersTableWidget->setItem(row, 3,
            new QTableWidgetItem(order["arrivalCity"].toString()));
        ui->ordersTableWidget->setItem(row, 4,
            new QTableWidgetItem(order["flightDate"].toString()));
        ui->ordersTableWidget->setItem(row, 5,
            new QTableWidgetItem(order["seatType"].toString()));
        ui->ordersTableWidget->setItem(row, 6,
            new QTableWidgetItem(QString::number(order["quantity"].toInt())));
        ui->ordersTableWidget->setItem(row, 7,
            new QTableWidgetItem(QString::number(order["totalPrice"].toDouble())));
        ui->ordersTableWidget->setItem(row, 8,
            new QTableWidgetItem(order["status"].toString()));
        
        // ä¿å­˜orderID
        ui->ordersTableWidget->item(row, 0)->setData(Qt::UserRole,
            order["orderID"].toString());
    }
}
```

### 3.6 æ”¹é€ å–æ¶ˆè®¢å•åŠŸèƒ½

#### æ”¹é€ åçš„ä»£ç 

```cpp
void SingleCenter::on_cancelButton_clicked()
{
    int row = ui->ordersTableWidget->currentRow();
    if (row < 0) {
        QMessageBox::warning(this, "æç¤º", "è¯·å…ˆé€‰æ‹©è¦å–æ¶ˆçš„è®¢å•ï¼");
        return;
    }
    
    QString orderID = ui->ordersTableWidget->item(row, 0)
                      ->data(Qt::UserRole).toString();
    
    int ret = QMessageBox::question(this, "ç¡®è®¤", "ç¡®å®šè¦å–æ¶ˆè¿™ä¸ªè®¢å•å—ï¼Ÿ",
                                    QMessageBox::Yes | QMessageBox::No);
    if (ret != QMessageBox::Yes) {
        return;
    }
    
    NetworkClient *client = NetworkManager::instance()->client();
    
    connect(client, &NetworkClient::responseReceived,
            this, &SingleCenter::onCancelOrderResponse, Qt::UniqueConnection);
    
    QJsonObject data;
    data["orderID"] = orderID;
    
    client->sendRequest(MSG_CANCEL_ORDER, data);
}

void SingleCenter::onCancelOrderResponse(int msgType, bool success,
                                         const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_CANCEL_ORDER_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &SingleCenter::onCancelOrderResponse);
    
    if (success) {
        QMessageBox::information(this, "æˆåŠŸ", "è®¢å•å·²å–æ¶ˆ");
        loadOrders();  // é‡æ–°åŠ è½½è®¢å•åˆ—è¡¨
    } else {
        QMessageBox::warning(this, "å¤±è´¥", message);
    }
}
```

### 3.7 æ”¹é€ æ”¶è—åŠŸèƒ½

#### æ·»åŠ æ”¶è—

```cpp
void Deal::on_addFavoriteButton_clicked()
{
    int row = ui->tableWidget_tickets->currentRow();
    if (row < 0) {
        QMessageBox::warning(this, "æç¤º", "è¯·å…ˆé€‰æ‹©è¦æ”¶è—çš„ç¥¨åŠ¡ï¼");
        return;
    }
    
    QString ticketID = ui->tableWidget_tickets->item(row, 0)
                      ->data(Qt::UserRole).toString();
    
    NetworkClient *client = NetworkManager::instance()->client();
    
    connect(client, &NetworkClient::responseReceived,
            this, &Deal::onAddFavoriteResponse, Qt::UniqueConnection);
    
    QJsonObject data;
    data["userID"] = m_userID;
    data["ticketID"] = ticketID;
    
    client->sendRequest(MSG_ADD_FAVORITE, data);
}

void Deal::onAddFavoriteResponse(int msgType, bool success,
                                 const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_ADD_FAVORITE_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &Deal::onAddFavoriteResponse);
    
    if (success) {
        QMessageBox::information(this, "æˆåŠŸ", "æ”¶è—æˆåŠŸï¼");
    } else {
        QMessageBox::warning(this, "å¤±è´¥", message);
    }
}
```

#### è·å–æ”¶è—åˆ—è¡¨

```cpp
void FavoriteDialog::loadFavorites()
{
    NetworkClient *client = NetworkManager::instance()->client();
    
    connect(client, &NetworkClient::responseReceived,
            this, &FavoriteDialog::onGetFavoritesResponse, Qt::UniqueConnection);
    
    QJsonObject data;
    data["userID"] = m_userID;
    
    client->sendRequest(MSG_GET_FAVORITES, data);
}

void FavoriteDialog::onGetFavoritesResponse(int msgType, bool success,
                                            const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_GET_FAVORITES_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &FavoriteDialog::onGetFavoritesResponse);
    
    if (!success) {
        QMessageBox::warning(this, "é”™è¯¯", message);
        return;
    }
    
    QJsonArray favorites = data["favorites"].toArray();
    ui->favoritesTableWidget->setRowCount(0);
    
    for (const QJsonValue &value : favorites) {
        QJsonObject favorite = value.toObject();
        
        int row = ui->favoritesTableWidget->rowCount();
        ui->favoritesTableWidget->insertRow(row);
        
        // å¡«å……è¡¨æ ¼...
        ui->favoritesTableWidget->setItem(row, 0,
            new QTableWidgetItem(favorite["flightNumber"].toString()));
        // ... å…¶ä»–åˆ— ...
        
        // ä¿å­˜favoriteID
        ui->favoritesTableWidget->item(row, 0)->setData(Qt::UserRole,
            favorite["favoriteID"].toString());
    }
}
```

#### åˆ é™¤æ”¶è—

```cpp
void FavoriteDialog::on_deleteButton_clicked()
{
    int row = ui->favoritesTableWidget->currentRow();
    if (row < 0) {
        QMessageBox::warning(this, "æç¤º", "è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„æ”¶è—ï¼");
        return;
    }
    
    QString favoriteID = ui->favoritesTableWidget->item(row, 0)
                         ->data(Qt::UserRole).toString();
    
    NetworkClient *client = NetworkManager::instance()->client();
    
    connect(client, &NetworkClient::responseReceived,
            this, &FavoriteDialog::onDeleteFavoriteResponse, Qt::UniqueConnection);
    
    QJsonObject data;
    data["favoriteID"] = favoriteID;
    
    client->sendRequest(MSG_DELETE_FAVORITE, data);
}

void FavoriteDialog::onDeleteFavoriteResponse(int msgType, bool success,
                                              const QString &message, const QJsonObject &data)
{
    if (msgType != MSG_DELETE_FAVORITE_RESPONSE) {
        return;
    }
    
    disconnect(NetworkManager::instance()->client(),
               &NetworkClient::responseReceived,
               this, &FavoriteDialog::onDeleteFavoriteResponse);
    
    if (success) {
        QMessageBox::information(this, "æˆåŠŸ", "åˆ é™¤æˆåŠŸï¼");
        loadFavorites();  // é‡æ–°åŠ è½½åˆ—è¡¨
    } else {
        QMessageBox::warning(this, "å¤±è´¥", message);
    }
}
```

---

## ğŸ“ å®Œæ•´ä»£ç ç¤ºä¾‹

### åè®®å¤´æ–‡ä»¶ï¼ˆéœ€è¦å¤åˆ¶åˆ°å®¢æˆ·ç«¯é¡¹ç›®ï¼‰

åœ¨å®¢æˆ·ç«¯é¡¹ç›®ä¸­åˆ›å»º `protocol.h`ï¼ˆä¸æœåŠ¡ç«¯ç›¸åŒï¼‰ï¼š

```cpp
#ifndef PROTOCOL_H
#define PROTOCOL_H

enum MessageType {
    // ç”¨æˆ·ç›¸å…³
    MSG_LOGIN = 1001,
    MSG_LOGIN_RESPONSE = 1002,
    MSG_REGISTER = 1003,
    MSG_REGISTER_RESPONSE = 1004,
    
    // ç¥¨åŠ¡æŸ¥è¯¢
    MSG_SEARCH_TICKETS = 2001,
    MSG_SEARCH_RESPONSE = 2002,
    
    // è®¢å•ç›¸å…³
    MSG_CREATE_ORDER = 3001,
    MSG_CREATE_ORDER_RESPONSE = 3002,
    MSG_GET_ORDERS = 3003,
    MSG_GET_ORDERS_RESPONSE = 3004,
    MSG_CANCEL_ORDER = 3005,
    MSG_CANCEL_ORDER_RESPONSE = 3006,
    
    // æ”¶è—ç›¸å…³
    MSG_ADD_FAVORITE = 4001,
    MSG_ADD_FAVORITE_RESPONSE = 4002,
    MSG_GET_FAVORITES = 4003,
    MSG_GET_FAVORITES_RESPONSE = 4004,
    MSG_DELETE_FAVORITE = 4005,
    MSG_DELETE_FAVORITE_RESPONSE = 4006
};

#endif // PROTOCOL_H
```

---

## ğŸ§ª æµ‹è¯•å’Œè°ƒè¯•

### æµ‹è¯•æ­¥éª¤

1. **å¯åŠ¨æœåŠ¡ç«¯**
   ```
   è¿è¡Œ FlightServer.exe
   ç¡®ä¿çœ‹åˆ°ï¼š"æœåŠ¡ç«¯å·²å¯åŠ¨ï¼Œç›‘å¬ç«¯å£ï¼š8888"
   ```

2. **å¯åŠ¨å®¢æˆ·ç«¯**
   ```
   è¿è¡Œå®¢æˆ·ç«¯ç¨‹åº
   åº”è¯¥è‡ªåŠ¨è¿æ¥åˆ°æœåŠ¡å™¨
   ```

3. **æµ‹è¯•ç™»å½•**
   - è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
   - ç‚¹å‡»ç™»å½•
   - æ£€æŸ¥æ˜¯å¦èƒ½æ”¶åˆ°å“åº”

4. **æµ‹è¯•å…¶ä»–åŠŸèƒ½**
   - æŒ‰é¡ºåºæµ‹è¯•ï¼šæ³¨å†Œã€æŸ¥è¯¢ã€è®¢å•ã€æ”¶è—

### è°ƒè¯•æŠ€å·§

#### 1. æ·»åŠ è°ƒè¯•è¾“å‡º

åœ¨ `NetworkClient::sendRequest()` ä¸­æ·»åŠ ï¼š
```cpp
qDebug() << "å‘é€è¯·æ±‚ï¼š" << QJsonDocument(request).toJson();
```

åœ¨ `NetworkClient::onReadyRead()` ä¸­æ·»åŠ ï¼š
```cpp
qDebug() << "æ”¶åˆ°å“åº”ï¼š" << QJsonDocument(doc).toJson();
```

#### 2. æ£€æŸ¥ç½‘ç»œè¿æ¥

```cpp
if (!NetworkManager::instance()->client()->isConnected()) {
    QMessageBox::critical(this, "é”™è¯¯", "æœªè¿æ¥åˆ°æœåŠ¡å™¨ï¼");
    return;
}
```

#### 3. ä½¿ç”¨ Wireshark æŠ“åŒ…

- è¿‡æ»¤ï¼š`tcp.port == 8888`
- æŸ¥çœ‹æ•°æ®åŒ…å†…å®¹ï¼ŒéªŒè¯åè®®æ ¼å¼

---

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šè¿æ¥å¤±è´¥

**åŸå› **ï¼š
- æœåŠ¡ç«¯æœªå¯åŠ¨
- ç«¯å£è¢«å ç”¨
- é˜²ç«å¢™é˜»æ­¢

**è§£å†³**ï¼š
- ç¡®ä¿æœåŠ¡ç«¯å·²å¯åŠ¨
- æ£€æŸ¥ç«¯å£8888æ˜¯å¦å¯ç”¨
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### é—®é¢˜2ï¼šæ”¶åˆ°æ•°æ®ä½†è§£æå¤±è´¥

**åŸå› **ï¼š
- JSONæ ¼å¼é”™è¯¯
- ç¼–ç é—®é¢˜

**è§£å†³**ï¼š
- æ£€æŸ¥å‘é€çš„JSONæ ¼å¼
- ç¡®ä¿ä½¿ç”¨UTF-8ç¼–ç 

### é—®é¢˜3ï¼šä¿¡å·æ§½è¿æ¥é—®é¢˜

**åŸå› **ï¼š
- ä¿¡å·è¿æ¥äº†å¤šæ¬¡
- å“åº”å¤„ç†å‡½æ•°è¢«è°ƒç”¨å¤šæ¬¡

**è§£å†³**ï¼š
- ä½¿ç”¨ `Qt::UniqueConnection`
- å¤„ç†å®Œå“åº”åç«‹å³æ–­å¼€è¿æ¥

### é—®é¢˜4ï¼šuserIDä¸¢å¤±

**åŸå› **ï¼š
- ç™»å½•åæ²¡æœ‰ä¿å­˜userID

**è§£å†³**ï¼š
- åœ¨ç™»å½•æˆåŠŸåä¿å­˜userIDåˆ°æˆå‘˜å˜é‡
- åœ¨éœ€è¦çš„åœ°æ–¹ä½¿ç”¨ä¿å­˜çš„userID

---

## ğŸ“‹ æ”¹é€ æ£€æŸ¥æ¸…å•

### å¿…é¡»å®Œæˆçš„ä»»åŠ¡

- [ ] åˆ›å»º `NetworkClient` ç±»
- [ ] åˆ›å»º `NetworkManager` å•ä¾‹
- [ ] ä¿®æ”¹ `.pro` æ–‡ä»¶æ·»åŠ  `network` æ¨¡å—
- [ ] ä¿®æ”¹ `main.cpp` ç§»é™¤æ•°æ®åº“è¿æ¥ï¼Œæ·»åŠ ç½‘ç»œè¿æ¥
- [ ] æ”¹é€ ç™»å½•åŠŸèƒ½
- [ ] æ”¹é€ æ³¨å†ŒåŠŸèƒ½
- [ ] æ”¹é€ æŸ¥è¯¢ç¥¨åŠ¡åŠŸèƒ½
- [ ] æ”¹é€ åˆ›å»ºè®¢å•åŠŸèƒ½
- [ ] æ”¹é€ è·å–è®¢å•åˆ—è¡¨åŠŸèƒ½
- [ ] æ”¹é€ å–æ¶ˆè®¢å•åŠŸèƒ½
- [ ] æ”¹é€ æ·»åŠ æ”¶è—åŠŸèƒ½
- [ ] æ”¹é€ è·å–æ”¶è—åˆ—è¡¨åŠŸèƒ½
- [ ] æ”¹é€ åˆ é™¤æ”¶è—åŠŸèƒ½
- [ ] åˆ é™¤æ‰€æœ‰æ•°æ®åº“ç›¸å…³ä»£ç 
- [ ] æµ‹è¯•æ‰€æœ‰åŠŸèƒ½

### ä»£ç æ¸…ç†

- [ ] åˆ é™¤ `ConnectDatabase()` å‡½æ•°
- [ ] åˆ é™¤æ‰€æœ‰ `QSqlQuery` ç›¸å…³ä»£ç 
- [ ] åˆ é™¤æ‰€æœ‰ `QSqlDatabase` ç›¸å…³ä»£ç 
- [ ] åˆ é™¤æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²

---

## ğŸ¯ æ€»ç»“

### æ”¹é€ æ ¸å¿ƒè¦ç‚¹

1. **ç§»é™¤æ•°æ®åº“æ“ä½œ**ï¼šæ‰€æœ‰æ•°æ®åº“æ“ä½œç§»åˆ°æœåŠ¡ç«¯
2. **æ·»åŠ ç½‘ç»œé€šä¿¡**ï¼šä½¿ç”¨ `NetworkClient` å‘é€è¯·æ±‚å’Œæ¥æ”¶å“åº”
3. **å¼‚æ­¥å¤„ç†**ï¼šä½¿ç”¨ä¿¡å·æ§½æœºåˆ¶å¤„ç†å“åº”
4. **ç»Ÿä¸€åè®®**ï¼šä½¿ç”¨ç›¸åŒçš„æ¶ˆæ¯æ ¼å¼å’Œé•¿åº¦å‰ç¼€

### æ”¹é€ åçš„æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         TCP Socket          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚   æœåŠ¡ç«¯    â”‚
â”‚  (Qt GUI)   â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ (Qt Server) â”‚
â”‚             â”‚         JSON æ•°æ®           â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚  MySQL æ•°æ®åº“â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æ–‡ä»¶

- `networkclient.h/cpp` - ç½‘ç»œå®¢æˆ·ç«¯ç±»
- `networkmanager.h/cpp` - ç½‘ç»œç®¡ç†å™¨å•ä¾‹
- `protocol.h` - åè®®å®šä¹‰ï¼ˆä¸æœåŠ¡ç«¯ç›¸åŒï¼‰
- å„åŠŸèƒ½æ¨¡å—çš„å“åº”å¤„ç†å‡½æ•°

---

**ç¥ä½ æ”¹é€ é¡ºåˆ©ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒæœåŠ¡ç«¯ä»£ç æˆ–æŸ¥çœ‹è°ƒè¯•è¾“å‡ºã€‚**

